(this["webpackJsonpclicker-game"]=this["webpackJsonpclicker-game"]||[]).push([[0],{31:function(e,t,a){e.exports=a(70)},36:function(e,t,a){},44:function(e,t,a){},63:function(e,t,a){},64:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(14),i=a.n(s),c=(a(36),a(1)),o=a.n(c),u=a(7),l=a(2),p=a(8),m=a(9),d=a(11),f=a(10),g=a(5),h=(a(44),"game/FETCH_REQUEST"),v="game/FETCH_ERROR",S="game/FETCH_SUCCESS",b="game/SET_GAME_CONFIG",E="game/UPDATE_WINNERS",y="game/SET_GAME_STATUS",I="game/GET_AVAILABLE_SETTINGS",O="game/SET_LAST_WINNER",N={fetchRequest:function(){return{type:h}},fetchError:function(e){return{type:v,payload:e}},fetchSuccess:function(){return{type:S}},setGameConfig:function(e){return{type:b,payload:e}},setGameStatus:function(e){return{type:y,payload:e}},updateWinners:function(e){return{type:E,payload:e}},setLastWinner:function(e){return{type:O,payload:e}},getAvailableSettings:function(e){return{type:I,payload:e}}},k=a(13),x=a.n(k);x.a.defaults.baseURL="https://starnavi-frontend-test-task.herokuapp.com/";var w=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/game-settings");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("/winners");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("/winners",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M={requestGameSettings:function(){return function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(N.fetchRequest()),e.prev=1,e.next=4,w();case 4:a=e.sent,t(N.getAvailableSettings(a)),t(N.fetchSuccess()),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(N.fetchError(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},requestWinners:function(){return function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(N.fetchRequest()),e.prev=1,e.next=4,A();case 4:a=e.sent,t(N.updateWinners(a)),t(N.fetchSuccess()),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(N.fetchError(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},updateWinners:function(e){return function(){var t=Object(l.a)(o.a.mark((function t(a){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(N.fetchRequest()),t.prev=1,t.next=4,T({winner:e.name,date:e.date});case 4:n=t.sent,a(N.setLastWinner(e.type)),a(N.updateWinners(n)),a(N.fetchSuccess()),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),a(N.fetchError(t.t0.message));case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e){return t.apply(this,arguments)}}()}},j=Object.freeze({INITIAL:"initial",PAUSED:"paused",STARTED:"started",FINISHED:"finished"}),G=Object.freeze({PLAY:"Play",RESUME:"Resume",PAUSE:"Pause",PLAY_AGAIN:"Play Again"}),_=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){var e;return Object(p.a)(this,a),(e=t.call(this)).updateGameConfig=function(){var t={mode:e.props.availableSettings[e.state.gameMode],playerName:e.state.playerName};e.props.setGameConfig(t)},e.updateGameStatus=function(){var t;switch(e.props.gameStatus){case j.INITIAL:case j.PAUSED:case j.FINISHED:t=j.STARTED;break;case j.STARTED:t=j.PAUSED;break;default:t=j.INITIAL}e.props.setGameStatus(t)},e.onFormSubmit=function(t){t.preventDefault(),e.state.gameMode&&e.state.playerName?(e.setState({validationPassed:!0}),e.updateGameConfig({playerName:e.state.playerName}),e.updateGameStatus()):e.setState({validationPassed:!1})},e.onChange=function(){var t=Object(l.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState(Object(u.a)({},a.target.name,a.target.value));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onSelect=function(){var t=Object(l.a)(o.a.mark((function t(a){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.onChange(a);case 2:e.props.gameStatus!==j.INITIAL&&e.props.gameStatus!==j.FINISHED||e.updateGameConfig();case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={gameMode:"",playerName:"",validationPassed:!0},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.requestGameSettings();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a;switch(this.props.gameStatus){case j.INITIAL:e=G.PLAY,t="start",a=!1;break;case j.PAUSED:e=G.RESUME,t="start",a=!0;break;case j.STARTED:e=G.PAUSE,t="pause",a=!0;break;case j.FINISHED:e=G.PLAY_AGAIN,t="start",a=!1;break;default:e=G.PLAY,t="start",a=!1}return r.a.createElement("div",{className:"control-panel__wrapper"},r.a.createElement("form",{className:"control-panel",onSubmit:this.onFormSubmit},r.a.createElement("select",{id:"gameMode",name:"gameMode",disabled:this.props.loading||a,className:"control-panel__field control-panel__field--select ".concat(this.props.loading||a?"disabled":""),value:this.state.gameMode,onChange:this.onSelect},r.a.createElement("option",{value:"",disabled:!0,hidden:!0},this.props.loading?"Loading...":"Pick game mode"),this.props.availableSettings?Object.keys(this.props.availableSettings).map((function(e){return r.a.createElement("option",{className:"select-option",value:e,key:e},e.slice(0,e.length-4))})):[]),r.a.createElement("input",{type:"text",id:"player-name",name:"playerName",disabled:this.props.loading||a,placeholder:"Please, enter your name",className:"control-panel__field control-panel__field--input ".concat(this.props.loading||a?"disabled":""),maxLength:"20",value:this.state.playerName,onChange:this.onChange}),r.a.createElement("button",{type:"submit",className:"control-panel__button ".concat(t," ").concat(this.props.loading?"disabled":"active"),disabled:this.props.loading},e)),r.a.createElement("p",{className:"validation-message ".concat(this.state.validationPassed?"hide":"show")},"Please, fill all the fields!"))}}]),a}(n.Component),C={setGameConfig:N.setGameConfig,setGameStatus:N.setGameStatus,requestGameSettings:M.requestGameSettings},D=Object(g.b)((function(e){return{gameConfig:e.game.gameConfig,gameStatus:e.game.gameStatus,availableSettings:e.game.availableSettings,loading:e.game.loading}}),C)(_),L=a(6),R=a(12),q=a(28);a(63);var P=function(e){var t=e.id,a=e.color,n=e.animation,s=e.onClick,i=e.onMouseOver,c=e.onAnimationEnd;return r.a.createElement("div",{className:"square ".concat(a," ").concat(n),id:t,onClick:s,onMouseOver:i,onAnimationEnd:c})},U=(a(64),Object.freeze({COMPUTER:"computer",USER:"user"}));var W=Object.freeze({GREY:"grey",GREEN:"green",RED:"red",BLUE:"blue"}),F=Object.freeze({DEFAULT:"default",HIGHLIGHTED:"highlighted",TAKEN:"taken",LOST:"lost"}),H=Object.freeze({scale:"scale",bigScale:"bigScale"}),Y={status:F.DEFAULT,animation:""},z=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).createMatrix=function(e){for(var t=[],a=0,n=0;n<e;n++){for(var r=[],s=0;s<e;s++)r.push(Object(R.a)({id:a},Y)),a=++a;t.push(r)}return t},n.getSquareInMatrix=function(e){var t;return Object(L.a)(n.state.fieldsMatrix).forEach((function(a){var n=a.find((function(t){return Number(t.id)===Number(e)}));n&&(t=n)})),t},n.replaceSquareInMatrix=function(){var e=Object(l.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=Object(L.a)(n.state.fieldsMatrix)).forEach((function(e){var a=e.find((function(e){return Number(e.id)===Number(t.id)}));a&&(e[e.indexOf(a)]=t)})),e.next=4,n.setState({fieldsMatrix:a});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.replaceSquareProp=function(e,t,a){var r=n.getSquareInMatrix(e),s=Object(R.a)({},r,Object(u.a)({},t,a));n.replaceSquareInMatrix(s)},n.filterMatrix=function(e){function t(t){return e?t.status===e:t}var a=[];return n.state.fieldsMatrix.forEach((function(e){var n=e.filter(t);a=[].concat(Object(L.a)(a),Object(L.a)(n))})),a},n.onMouseOverSquare=function(e){n.replaceSquareProp(e.target.id,"animation",H.scale)},n.onAnimationEnd=function(e){n.replaceSquareProp(e.target.id,"animation","")},n.highlightSquare=function(e){n.replaceSquareProp(e,"status",F.HIGHLIGHTED)},n.loseSquare=function(e){n.replaceSquareProp(e,"status",F.LOST)},n.takeSquare=function(e){n.replaceSquareProp(e,"status",F.TAKEN)},n.onSquareClick=function(e){n.replaceSquareProp(e.target.id,"animation",H.bigScale);var t=n.getSquareInMatrix(e.target.id);t.status===F.HIGHLIGHTED&&(n.takeSquare(t.id),n.setState({highlightedFieldId:null}))},n.checkWinner=function(){var e=n.filterMatrix(),t=n.filterMatrix(F.TAKEN),a=n.filterMatrix(F.LOST),r=Math.ceil(e.length/2);return t.length>=r?U.USER:a.length>=r?U.COMPUTER:null},n.runGame=function(){return setInterval(function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,r,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===n.state.highlightedFieldId){e.next=3;break}return e.next=3,n.loseSquare(n.state.highlightedFieldId);case 3:if(!(t=n.checkWinner())){e.next=7;break}return n.finishGame(t),e.abrupt("return");case 7:return a=n.filterMatrix(F.DEFAULT),i=a.length-1,r=Math.floor(Math.random()*Math.floor(i)),s=a[r],n.highlightSquare(s.id),e.next=13,n.setState({highlightedFieldId:s.id});case 13:case"end":return e.stop()}var i}),e)})));return function(){return e.apply(this,arguments)}}(),n.props.gameConfig.mode.delay)},n.pauseGame=function(){clearInterval(n.state.intervalId)},n.finishGame=function(e){clearInterval(n.state.intervalId),n.props.setGameStatus(j.FINISHED);var t={name:e===U.USER?n.props.gameConfig.playerName:e,type:e,date:q().format("h:mm:ss a; MMMM Do YYYY")};n.props.updateWinners(t)},n.state={fieldsMatrix:[],intervalId:null,highlightedFieldId:null},n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=this.createMatrix(this.props.gameConfig.mode.field);this.setState({fieldsMatrix:e})}},{key:"componentDidUpdate",value:function(e){if(e.gameConfig.mode.field!==this.props.gameConfig.mode.field){var t=this.createMatrix(this.props.gameConfig.mode.field);this.setState({fieldsMatrix:t})}if((e.gameStatus===j.INITIAL||e.gameStatus===j.FINISHED)&&e.gameStatus!==this.props.gameStatus){var a=this.createMatrix(this.props.gameConfig.mode.field);this.setState({fieldsMatrix:a,highlightedFieldId:null})}if(e.gameStatus!==this.props.gameStatus&&this.props.gameStatus===j.STARTED){var n=this.runGame();this.setState({intervalId:n})}e.gameStatus!==this.props.gameStatus&&this.props.gameStatus===j.PAUSED&&this.pauseGame()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"game-field ".concat(this.props.gameStatus&&this.props.gameStatus===j.STARTED?"":"disabled")},this.state.fieldsMatrix.map((function(t){return r.a.createElement("div",{className:"game-field__row",key:e.state.fieldsMatrix.indexOf(t)},t.map((function(t){var a;switch(t.status){case F.DEFAULT:a=W.GREY;break;case F.HIGHLIGHTED:a=W.BLUE;break;case F.TAKEN:a=W.GREEN;break;case F.LOST:a=W.RED;break;default:a=W.GREY}return r.a.createElement(P,{id:t.id,color:a,key:t.id,animation:t.animation,onClick:e.onSquareClick,onMouseOver:e.onMouseOverSquare,onAnimationEnd:e.onAnimationEnd})})))})))}}]),a}(n.Component),B={setGameStatus:N.setGameStatus,updateWinners:M.updateWinners},K=Object(g.b)((function(e){return{gameConfig:e.game.gameConfig,gameStatus:e.game.gameStatus,loading:e.game.loading}}),B)(z),J=(a(65),Object.freeze({beforeStart:"Let's play, fellow!",gameIsGoing:"Good luck, mate!",resumeGame:"Don't stop, mate!",gameIsWon:"Wow! You've beated me! Crazy guy!",gameOver:"Oops, You've Lost! Wanna try again?"}));var Q=Object(g.b)((function(e){return{gameStatus:e.game.gameStatus,lastWinner:e.game.lastWinner}}))((function(e){var t;switch(e.gameStatus){case j.INITIAL:t=J.beforeStart;break;case j.PAUSED:t=J.resumeGame;break;case j.STARTED:t=J.gameIsGoing;break;case j.FINISHED:e.lastWinner===U.COMPUTER?t=J.gameOver:e.lastWinner===U.USER&&(t=J.gameIsWon);break;default:t=J.beforeStart}return r.a.createElement("div",{className:"game__wrapper"},r.a.createElement("h2",{className:"game__message"},t),r.a.createElement(K,null))}));a(66);function V(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"game-screen__header"},r.a.createElement(D,null)),r.a.createElement("main",{className:"game-screen__content"},r.a.createElement(Q,null)))}a(67);var $=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(){return Object(p.a)(this,a),t.apply(this,arguments)}return Object(m.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.requestWinners();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("ul",{className:"leaders-table"},this.props.winners&&this.props.winners.reverse().map((function(e){return r.a.createElement("li",{className:"leaders-table__row",key:e.id},r.a.createElement("span",{className:"leaders-table__text name"},e.winner),r.a.createElement("span",{className:"leaders-table__text date"},e.date))})))}}]),a}(n.Component),X={requestWinners:M.requestWinners},Z=Object(g.b)((function(e){return{winners:e.game.winners}}),X)($);a(68);function ee(){return r.a.createElement("div",{className:"leader-board"},r.a.createElement("h2",{className:"leader-board__title"},"Leader Board"),r.a.createElement(Z,null))}var te=function(){return r.a.createElement("main",{className:"base-layout"},r.a.createElement("section",{className:"base-layout__section"},r.a.createElement(V,null)),r.a.createElement("section",{className:"base-layout__section"},r.a.createElement(ee,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(69);var ae=a(4),ne=a(29),re=a(30),se=Object.freeze({mode:{field:5,delay:2e3},playerName:""});var ie=Object(ae.combineReducers)({gameConfig:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(R.a)({},se),t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case b:return Object(R.a)({},e,{},n);default:return e}},gameStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j.INITIAL,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case y:return n;default:return e}},availableSettings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case I:return n;default:return e}},winners:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case E:return Object(L.a)(n);default:return e}},lastWinner:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case O:return n;default:return e}},loading:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0,a=t.type;switch(a){case h:return!0;case S:case v:return!1;default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case h:return null;case v:return n;default:return e}}}),ce=Object(ae.combineReducers)({game:ie}),oe=Object(ae.applyMiddleware)(re.a),ue=Object(ne.composeWithDevTools)(oe),le=Object(ae.createStore)(ce,ue);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(g.a,{store:le},r.a.createElement(te,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[31,1,2]]]);
//# sourceMappingURL=main.1d4d112a.chunk.js.map